version: 2.1
orbs:
  # This Orb includes the following:
  # - checkout current repository
  # - npm install with caching
  # - start the server
  # - wait for the server to respond
  # - run Cypress tests
  # - store videos and screenshots as artifacts on CircleCI
  #https://github.com/cypress-io/circleci-orb/blob/master/docs/examples.md
  cypress: cypress-io/cypress@1
workflows:
  build:
    jobs:
      - cypress/run:
          env: 'REACT_APP_NOT_SECRET_CODE=https://express-api-react-notion.vercel.app,CYPRESS_BASE_URL=http://localhost:3000'
          #Runs all Cypress tests on Node 14
          executor: cypress/base-14
          start: npm start
          wait-on: 'http://localhost:3000'
              